<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº‹ä»¶è¯¦æƒ… - æ…ˆå–„äº‹ä»¶ç®¡ç†ç³»ç»Ÿ</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <i class="fas fa-heart"></i>
                <span>æ…ˆå–„äº‹ä»¶ç®¡ç†</span>
            </div>
            <div class="nav-menu">
                <a href="index.html" class="nav-link">
                    <i class="fas fa-home"></i> é¦–é¡µ
                </a>
                <a href="search.html" class="nav-link">
                    <i class="fas fa-search"></i> æœç´¢äº‹ä»¶
                </a>
                <a href="#" class="nav-link" onclick="showAbout()">
                    <i class="fas fa-info-circle"></i> å…³äºæˆ‘ä»¬
                </a>
            </div>
        </div>
    </nav>

    <!-- ä¸»è¦å†…å®¹ -->
    <main>
        <!-- äº‹ä»¶è¯¦æƒ…å¤´éƒ¨ -->
        <section class="event-header">
            <div class="container">
                <div class="breadcrumb">
                    <a href="index.html"><i class="fas fa-home"></i> é¦–é¡µ</a>
                    <i class="fas fa-chevron-right"></i>
                    <span id="eventTitle">äº‹ä»¶è¯¦æƒ…</span>
                </div>
            </div>
        </section>

        <!-- äº‹ä»¶è¯¦æƒ…å†…å®¹ -->
        <section class="event-detail">
            <div class="container">
                <div class="event-detail-grid">
                    <!-- äº‹ä»¶ä¿¡æ¯å¡ç‰‡ -->
                    <div class="event-info-card">
                        <div class="event-image-large">
                            <i class="fas fa-calendar-check"></i>
                            <div class="event-status" id="eventStatus">å³å°†å¼€å§‹</div>
                        </div>
                        
                        <div class="event-info-content">
                            <h1 id="eventName">äº‹ä»¶åç§°</h1>
                            <div class="event-meta-detailed">
                                <div class="meta-item">
                                    <i class="fas fa-calendar"></i>
                                    <span id="eventDate">äº‹ä»¶æ—¥æœŸ</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span id="eventLocation">äº‹ä»¶åœ°ç‚¹</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-tag"></i>
                                    <span id="eventCategory">äº‹ä»¶åˆ†ç±»</span>
                                </div>
                                <div class="meta-item">
                                    <i class="fas fa-users"></i>
                                    <span id="eventCapacity">å®¹é‡ä¿¡æ¯</span>
                                </div>
                            </div>
                            
                            <div class="event-description-detailed">
                                <h3>äº‹ä»¶æè¿°</h3>
                                <p id="eventDescription">äº‹ä»¶è¯¦ç»†æè¿°...</p>
                            </div>
                            
                            <div class="event-stats">
                                <div class="stat-box">
                                    <div class="stat-number" id="registrationCount">0</div>
                                    <div class="stat-label">å·²æ³¨å†Œ</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-number" id="ticketsSold">0</div>
                                    <div class="stat-label">å·²å”®ç¥¨</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-number" id="currentAmount">$0</div>
                                    <div class="stat-label">å·²ç­¹æ¬¾</div>
                                </div>
                            </div>
                            
                            ${getQueryParam('id') ? `
                            <div class="event-actions-detailed">
                                <button class="btn btn-primary btn-large" onclick="registerForEvent()">
                                    <i class="fas fa-user-plus"></i> ç«‹å³æ³¨å†Œ
                                </button>
                                <button class="btn btn-secondary btn-large" onclick="shareEvent()">
                                    <i class="fas fa-share"></i> åˆ†äº«äº‹ä»¶
                                </button>
                            </div>
                            ` : ''}
                        </div>
                    </div>

                    <!-- ç­¹æ¬¾è¿›åº¦ -->
                    <div class="event-progress-card" id="progressCard" style="display: none;">
                        <h3>ç­¹æ¬¾è¿›åº¦</h3>
                        <div class="progress-container">
                            <div class="progress-bar-large">
                                <div class="progress-fill-large" id="progressFill"></div>
                            </div>
                            <div class="progress-info">
                                <span id="progressText">0% å®Œæˆ</span>
                                <span id="progressAmount">$0 / $0</span>
                            </div>
                        </div>
                    </div>

                    <!-- æ³¨å†Œåˆ—è¡¨ -->
                    <div class="registration-list-card">
                        <h3>å‚ä¸è®°å½•</h3>
                        <div class="registration-stats">
                            <div class="stat-item">
                                <span class="stat-number" id="totalRegistrations">0</span>
                                <span class="stat-label">æ€»å‚ä¸äººæ•°</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number" id="totalTickets">0</span>
                                <span class="stat-label">æ€»å”®ç¥¨æ•°</span>
                            </div>
                        </div>
                        
                        <div class="registration-list" id="registrationList">
                            <div class="loading">
                                <i class="fas fa-spinner fa-spin"></i>
                                <p>åŠ è½½å‚ä¸è®°å½•...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>å…³äºæˆ‘ä»¬</h3>
                    <p>è‡´åŠ›äºè¿æ¥æ…ˆå–„ç»„ç»‡ä¸çˆ±å¿ƒäººå£«ï¼Œæ¨åŠ¨ç¤¾ä¼šå…¬ç›Šäº‹ä¸šçš„å‘å±•ã€‚</p>
                </div>
                <div class="footer-section">
                    <h3>è”ç³»æ–¹å¼</h3>
                    <p><i class="fas fa-envelope"></i> contact@charityevents.com</p>
                    <p><i class="fas fa-phone"></i> +61 2 1234 5678</p>
                </div>
                <div class="footer-section">
                    <h3>å…³æ³¨æˆ‘ä»¬</h3>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 æ…ˆå–„äº‹ä»¶ç®¡ç†ç³»ç»Ÿ. PROG2002 A3é¡¹ç›®.</p>
            </div>
        </div>
    </footer>

    <!-- æ¨¡æ€æ¡† -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <div id="modal-body"></div>
        </div>
    </div>

    <script>
        // APIé…ç½®
        const API_BASE_URL = window.location.origin + '/api';
        let currentEvent = null;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventPage();
        });

        // åˆå§‹åŒ–äº‹ä»¶é¡µé¢
        async function initializeEventPage() {
            const eventId = getQueryParam('id');
            if (!eventId) {
                showError('æœªæŒ‡å®šäº‹ä»¶ID');
                return;
            }

            try {
                await loadEventDetails(eventId);
                await loadEventRegistrations(eventId);
            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                showError('åŠ è½½äº‹ä»¶è¯¦æƒ…å¤±è´¥');
            }
        }

        // è·å–URLå‚æ•°
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // åŠ è½½äº‹ä»¶è¯¦æƒ…
        async function loadEventDetails(eventId) {
            try {
                const response = await fetch(`${API_BASE_URL}/events/${eventId}`);
                const result = await response.json();

                if (result.success) {
                    currentEvent = result.data;
                    displayEventDetails(currentEvent);
                } else {
                    showError(result.error || 'äº‹ä»¶ä¸å­˜åœ¨');
                }
            } catch (error) {
                console.error('åŠ è½½äº‹ä»¶è¯¦æƒ…å¤±è´¥:', error);
                showError('åŠ è½½äº‹ä»¶è¯¦æƒ…å¤±è´¥');
            }
        }

        // æ˜¾ç¤ºäº‹ä»¶è¯¦æƒ…
        function displayEventDetails(event) {
            // æ›´æ–°é¡µé¢æ ‡é¢˜
            document.getElementById('eventTitle').textContent = event.event_name;
            document.getElementById('eventName').textContent = event.event_name;
            document.getElementById('eventDate').textContent = formatDate(event.event_date);
            document.getElementById('eventLocation').textContent = event.event_location;
            document.getElementById('eventCategory').textContent = event.category_name || 'æœªåˆ†ç±»';
            document.getElementById('eventDescription').textContent = event.event_description || 'æš‚æ— æè¿°';
            
            // æ›´æ–°äº‹ä»¶çŠ¶æ€
            const statusElement = document.getElementById('eventStatus');
            statusElement.textContent = getStatusText(event.event_status);
            statusElement.className = `event-status status-${event.event_status}`;
            
            // æ›´æ–°å®¹é‡ä¿¡æ¯
            document.getElementById('eventCapacity').textContent = 
                `${event.total_tickets_sold || 0} / ${event.max_tickets} äººå·²å‚ä¸`;
            
            // æ›´æ–°ç»Ÿè®¡æ•°æ®
            document.getElementById('registrationCount').textContent = event.registration_count || 0;
            document.getElementById('ticketsSold').textContent = event.total_tickets_sold || 0;
            document.getElementById('currentAmount').textContent = 
                `$${(event.current_amount || 0).toLocaleString()}`;

            // æ˜¾ç¤ºç­¹æ¬¾è¿›åº¦ï¼ˆå¦‚æœæœ‰ç›®æ ‡é‡‘é¢ï¼‰
            if (event.goal_amount > 0) {
                displayProgress(event.current_amount, event.goal_amount);
            }
        }

        // æ˜¾ç¤ºç­¹æ¬¾è¿›åº¦
        function displayProgress(current, goal) {
            const progressCard = document.getElementById('progressCard');
            const progressFill = document.getElementById('progressFill');
            const progressText = document.getElementById('progressText');
            const progressAmount = document.getElementById('progressAmount');

            const percentage = Math.min((current / goal) * 100, 100);
            
            progressCard.style.display = 'block';
            progressFill.style.width = `${percentage}%`;
            progressText.textContent = `${percentage.toFixed(1)}% å®Œæˆ`;
            progressAmount.textContent = `$${current.toLocaleString()} / $${goal.toLocaleString()}`;

            // æ·»åŠ è¿›åº¦åŠ¨ç”»
            setTimeout(() => {
                progressFill.style.transition = 'width 1s ease-in-out';
            }, 100);
        }

        // åŠ è½½äº‹ä»¶æ³¨å†Œä¿¡æ¯
        async function loadEventRegistrations(eventId) {
            try {
                const response = await fetch(`${API_BASE_URL}/registrations?event_id=${eventId}`);
                const result = await response.json();

                if (result.success) {
                    displayEventRegistrations(result.data);
                }
            } catch (error) {
                console.error('åŠ è½½æ³¨å†Œä¿¡æ¯å¤±è´¥:', error);
            }
        }

        // æ˜¾ç¤ºäº‹ä»¶æ³¨å†Œä¿¡æ¯
        function displayEventRegistrations(registrations) {
            const container = document.getElementById('registrationList');
            const totalRegElement = document.getElementById('totalRegistrations');
            const totalTicketsElement = document.getElementById('totalTickets');

            // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
            totalRegElement.textContent = registrations.length;
            const totalTickets = registrations.reduce((sum, reg) => sum + (reg.ticket_count || 0), 0);
            totalTicketsElement.textContent = totalTickets;

            if (registrations.length === 0) {
                container.innerHTML = `
                    <div class="no-registrations" style="text-align: center; padding: 40px; color: #7f8c8d;">
                        <i class="fas fa-user-check" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <p>æš‚æ— å‚ä¸è®°å½•</p>
                        <p style="font-size: 0.9rem; margin-top: 10px;">æˆä¸ºç¬¬ä¸€ä¸ªå‚ä¸è€…å§ï¼</p>
                    </div>
                `;
                return;
            }

            container.innerHTML = registrations.map(registration => createRegistrationItem(registration)).join('');
        }

        // åˆ›å»ºæ³¨å†Œé¡¹HTML
        function createRegistrationItem(registration) {
            const initials = registration.user_name.split('').filter(char => /[\u4e00-\u9fa5]/.test(char)).slice(0, 2).join('') || 
                            registration.user_name.substring(0, 2).toUpperCase();
            
            return `
                <div class="registration-item fade-in">
                    <div class="registration-avatar">
                        ${initials}
                    </div>
                    <div class="registration-content">
                        <div class="registration-user">${registration.user_name}</div>
                        <div class="registration-email">${registration.user_email}</div>
                        <div class="registration-time">${formatTimeAgo(registration.registration_date)}</div>
                    </div>
                    <div class="registration-tickets">
                        ${registration.ticket_count} å¼ ç¥¨
                    </div>
                </div>
            `;
        }

        // æ ¼å¼åŒ–æ—¥æœŸ
        function formatDate(dateString) {
            const date = new Date(dateString);
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            return date.toLocaleDateString('zh-CN', options);
        }

        // è·å–çŠ¶æ€æ–‡æœ¬
        function getStatusText(status) {
            const statusMap = {
                'upcoming': 'å³å°†å¼€å§‹',
                'past': 'å·²ç»“æŸ',
                'suspended': 'å·²æš‚åœ'
            };
            return statusMap[status] || status;
        }

        // æ ¼å¼åŒ–æ—¶é—´å·®
        function formatTimeAgo(dateString) {
            const date = new Date(dateString);
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) {
                return 'åˆšåˆš';
            } else if (diffInSeconds < 3600) {
                const minutes = Math.floor(diffInSeconds / 60);
                return `${minutes}åˆ†é’Ÿå‰`;
            } else if (diffInSeconds < 86400) {
                const hours = Math.floor(diffInSeconds / 3600);
                return `${hours}å°æ—¶å‰`;
            } else {
                const days = Math.floor(diffInSeconds / 86400);
                return `${days}å¤©å‰`;
            }
        }

        // æ³¨å†Œäº‹ä»¶
        function registerForEvent() {
            if (!currentEvent) return;

            // æ£€æŸ¥äº‹ä»¶çŠ¶æ€
            if (currentEvent.event_status === 'past') {
                showModal('äº‹ä»¶å·²ç»“æŸ', 'å¯¹ä¸èµ·ï¼Œè¯¥äº‹ä»¶å·²ç»ç»“æŸï¼Œæ— æ³•æ¥å—æ–°çš„æ³¨å†Œã€‚');
                return;
            }

            if (currentEvent.event_status === 'suspended') {
                showModal('äº‹ä»¶å·²æš‚åœ', 'å¯¹ä¸èµ·ï¼Œè¯¥äº‹ä»¶æš‚æ—¶æš‚åœæ³¨å†Œã€‚');
                return;
            }

            // æ£€æŸ¥å®¹é‡
            if (currentEvent.total_tickets_sold >= currentEvent.max_tickets) {
                showModal('äº‹ä»¶å·²æ»¡', 'å¯¹ä¸èµ·ï¼Œè¯¥äº‹ä»¶å·²ç»è¾¾åˆ°æœ€å¤§å®¹é‡ï¼Œæ— æ³•æ¥å—æ–°çš„æ³¨å†Œã€‚');
                return;
            }

            // æ˜¾ç¤ºæ³¨å†Œè¡¨å•
            showRegistrationForm();
        }

        // æ˜¾ç¤ºæ³¨å†Œè¡¨å•
        function showRegistrationForm() {
            const modalBody = document.getElementById('modal-body');
            
            modalBody.innerHTML = `
                <div style="padding: 30px;">
                    <h2 style="color: #2c3e50; margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-user-plus" style="color: #3498db;"></i> äº‹ä»¶æ³¨å†Œ
                    </h2>
                    
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="color: #2c3e50; margin-bottom: 10px;">${currentEvent.event_name}</h4>
                        <p style="color: #7f8c8d; margin-bottom: 5px;">
                            <i class="fas fa-calendar"></i> ${formatDate(currentEvent.event_date)}
                        </p>
                        <p style="color: #7f8c8d; margin-bottom: 5px;">
                            <i class="fas fa-map-marker-alt"></i> ${currentEvent.event_location}
                        </p>
                        <p style="color: #27ae60; font-weight: 600;">
                            <i class="fas fa-ticket-alt"></i> 
                            ${currentEvent.ticket_price === 0 ? 'å…è´¹' : `$${currentEvent.ticket_price}`}
                        </p>
                    </div>
                    
                    <form id="registrationForm" style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <label for="userName" style="display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50;">
                                å§“å *
                            </label>
                            <input type="text" id="userName" name="userName" required 
                                   style="width: 100%; padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 1rem;">
                        </div>
                        
                        <div>
                            <label for="userEmail" style="display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50;">
                                é‚®ç®± *
                            </label>
                            <input type="email" id="userEmail" name="userEmail" required 
                                   style="width: 100%; padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 1rem;">
                        </div>
                        
                        <div>
                            <label for="userPhone" style="display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50;">
                                ç”µè¯
                            </label>
                            <input type="tel" id="userPhone" name="userPhone" 
                                   style="width: 100%; padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 1rem;">
                        </div>
                        
                        <div>
                            <label for="ticketCount" style="display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50;">
                                ç¥¨æ•° *
                            </label>
                            <select id="ticketCount" name="ticketCount" required 
                                    style="width: 100%; padding: 12px; border: 2px solid #ecf0f1; border-radius: 8px; font-size: 1rem;">
                                ${generateTicketOptions()}
                            </select>
                        </div>
                        
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button type="button" onclick="closeModal()" class="btn btn-secondary" style="flex: 1;">
                                <i class="fas fa-times"></i> å–æ¶ˆ
                            </button>
                            <button type="submit" class="btn btn-primary" style="flex: 1;">
                                <i class="fas fa-check"></i> ç¡®è®¤æ³¨å†Œ
                            </button>
                        </div>
                    </form>
                </div>
            `;
            
            document.getElementById('modal').style.display = 'block';
            
            // æ·»åŠ è¡¨å•æäº¤äº‹ä»¶
            document.getElementById('registrationForm').addEventListener('submit', handleRegistrationSubmit);
        }

        // ç”Ÿæˆç¥¨æ•°é€‰é¡¹
        function generateTicketOptions() {
            const maxTickets = Math.min(5, currentEvent.max_tickets - (currentEvent.total_tickets_sold || 0));
            let options = '';
            for (let i = 1; i <= maxTickets; i++) {
                options += `<option value="${i}">${i} å¼ ç¥¨</option>`;
            }
            return options;
        }

        // å¤„ç†æ³¨å†Œæäº¤
        async function handleRegistrationSubmit(e) {
            e.preventDefault();
            
            const formData = new FormData(e.target);
            const registrationData = {
                event_id: currentEvent.event_id,
                user_name: formData.get('userName'),
                user_email: formData.get('userEmail'),
                user_phone: formData.get('userPhone') || null,
                ticket_count: parseInt(formData.get('ticketCount'))
            };

            // éªŒè¯è¡¨å•
            if (!registrationData.user_name || !registrationData.user_email) {
                showModal('è¡¨å•é”™è¯¯', 'è¯·å¡«å†™æ‰€æœ‰å¿…å¡«é¡¹');
                return;
            }

            // éªŒè¯é‚®ç®±æ ¼å¼
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(registrationData.user_email)) {
                showModal('é‚®ç®±æ ¼å¼é”™è¯¯', 'è¯·è¾“å…¥æœ‰æ•ˆçš„é‚®ç®±åœ°å€');
                return;
            }

            try {
                const response = await fetch(`${API_BASE_URL}/registrations`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(registrationData)
                });

                const result = await response.json();

                if (result.success) {
                    showModal('æ³¨å†ŒæˆåŠŸ', `
                        <div style="text-align: center;">
                            <i class="fas fa-check-circle" style="color: #27ae60; font-size: 3rem; margin-bottom: 20px;"></i>
                            <h3 style="color: #27ae60; margin-bottom: 15px;">æ³¨å†ŒæˆåŠŸï¼</h3>
                            <p>æ‚¨å·²æˆåŠŸæ³¨å†Œ "${currentEvent.event_name}" äº‹ä»¶ã€‚</p>
                            <p>æˆ‘ä»¬ä¼šå‘æ‚¨çš„é‚®ç®± ${registrationData.user_email} å‘é€ç¡®è®¤ä¿¡æ¯ã€‚</p>
                            <button onclick="closeModal(); location.reload();" class="btn btn-primary" style="margin-top: 20px;">
                                <i class="fas fa-check"></i> ç¡®å®š
                            </button>
                        </div>
                    `);
                } else {
                    showModal('æ³¨å†Œå¤±è´¥', result.error || 'æ³¨å†Œå¤±è´¥ï¼Œè¯·é‡è¯•');
                }
            } catch (error) {
                console.error('æ³¨å†Œå¤±è´¥:', error);
                showModal('æ³¨å†Œå¤±è´¥', 'ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•');
            }
        }

        // åˆ†äº«äº‹ä»¶
        function shareEvent() {
            if (!currentEvent) return;

            const shareUrl = window.location.href;
            const shareText = `å¿«æ¥å‚åŠ  "${currentEvent.event_name}" æ…ˆå–„æ´»åŠ¨ï¼`;

            if (navigator.share) {
                navigator.share({
                    title: shareText,
                    url: shareUrl
                });
            } else {
                // å¤åˆ¶åˆ°å‰ªè´´æ¿
                navigator.clipboard.writeText(shareUrl).then(() => {
                    showModal('åˆ†äº«é“¾æ¥', `
                        <div style="text-align: center;">
                            <i class="fas fa-link" style="color: #3498db; font-size: 3rem; margin-bottom: 20px;"></i>
                            <h3 style="margin-bottom: 15px;">é“¾æ¥å·²å¤åˆ¶</h3>
                            <p>äº‹ä»¶é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œæ‚¨å¯ä»¥åˆ†äº«ç»™æœ‹å‹ã€‚</p>
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 20px 0; word-break: break-all; font-size: 0.9rem;">
                                ${shareUrl}
                            </div>
                        </div>
                    `);
                });
            }
        }

        // æ˜¾ç¤ºæ¨¡æ€æ¡†
        function showModal(title, content) {
            const modalBody = document.getElementById('modal-body');
            modalBody.innerHTML = `
                <div style="padding: 30px;">
                    <h2 style="color: #2c3e50; margin-bottom: 20px; text-align: center;">
                        ${title}
                    </h2>
                    <div>${content}</div>
                </div>
            `;
            document.getElementById('modal').style.display = 'block';
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            document.getElementById('modal').style.display = 'none';
        }

        // æ˜¾ç¤ºå…³äºæˆ‘ä»¬
        function showAbout() {
            const modalBody = document.getElementById('modal-body');
            modalBody.innerHTML = `
                <div style="padding: 30px;">
                    <h2 style="color: #2c3e50; margin-bottom: 20px; text-align: center;">
                        <i class="fas fa-heart" style="color: #e74c3c;"></i> å…³äºæˆ‘ä»¬
                    </h2>
                    <div style="line-height: 1.8; color: #34495e;">
                        <p style="margin-bottom: 20px;">
                            æ…ˆå–„äº‹ä»¶ç®¡ç†ç³»ç»Ÿæ˜¯ä¸€ä¸ªè‡´åŠ›äºè¿æ¥æ…ˆå–„ç»„ç»‡ä¸çˆ±å¿ƒäººå£«çš„å¹³å°ã€‚
                            æˆ‘ä»¬ç›¸ä¿¡æ¯ä¸ªäººéƒ½èƒ½ä¸ºç¤¾ä¼šè´¡çŒ®ä¸€ä»½åŠ›é‡ã€‚
                        </p>
                        <p style="text-align: center; font-weight: 600; color: #2c3e50;">
                            "å‚ä¸æ…ˆå–„ï¼Œæ”¹å˜ä¸–ç•Œ"
                        </p>
                    </div>
                </div>
            `;
            document.getElementById('modal').style.display = 'block';
        }

        // æ¨¡æ€æ¡†äº‹ä»¶
        document.addEventListener('click', function(e) {
            const modal = document.getElementById('modal');
            const closeBtn = document.querySelector('.close');
            
            if (e.target === modal || e.target === closeBtn) {
                closeModal();
            }
        });

        document.addEventListener('keydown', function(e) {
            const modal = document.getElementById('modal');
            if (e.key === 'Escape' && modal.style.display === 'block') {
                closeModal();
            }
        });

        console.log('ğŸš€ PROG2002 A3 äº‹ä»¶è¯¦æƒ…é¡µé¢å·²åŠ è½½');
    </script>
</body>
</html>